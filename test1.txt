document.addEventListener("DOMContentLoaded", function () {
    var masterCheck = document.querySelector("#mastercheck");
    var subChecks = document.querySelectorAll(".subcheck");

    // Master checkbox change event
    masterCheck.addEventListener("change", function () {
        var isChecked = this.checked;
        subChecks.forEach(function (checkbox) {
            checkbox.checked = isChecked;
            toggleSwitches(checkbox);
        });
    });

    // Individual subcheck change event
    subChecks.forEach(function (checkbox) {
        checkbox.addEventListener("change", function () {
            toggleSwitches(checkbox);
            updateMasterCheck();
        });

        toggleSwitches(checkbox);
    });

    function toggleSwitches(checkbox) {
        var row = checkbox.closest("tr");
        var toggles = row.querySelectorAll(".toggle");

        toggles.forEach(function (toggle) {
            toggle.disabled = !checkbox.checked;
            if (!checkbox.checked) {
                toggle.checked = false;
            }
        });
    }

    function updateMasterCheck() {
        var allChecked = Array.from(subChecks).every(chk => chk.checked);
        masterCheck.checked = allChecked;
    }
});
